<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <title>Malaysian Architects AR</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Lato:wght@400;700&display=swap" rel="stylesheet">

    <style>
      body { margin: 0; overflow: hidden; font-family: 'Lato', sans-serif; background-color: #000; }
      
      /* --- UI LAYER (The "Menu" Screen) --- */
      #ui-layer {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        z-index: 2000; pointer-events: auto;
        background: #2c3e50;
        display: flex; flex-direction: column; 
      }

      /* TITLE SCREEN */
      #title-screen {
        width: 100%; height: 100%;
        display: flex; flex-direction: column; justify-content: center; align-items: center;
        background: linear-gradient(135deg, #1a1a2e 0%, #0f1526 100%);
        color: #f1c40f; text-align: center;
      }

      /* SELECTION CAROUSEL */
      #selection-screen {
        width: 100%; height: 100%; display: none;
        flex-direction: column; justify-content: center; align-items: center;
        background: #2c3e50;
      }
      .carousel-container { position: relative; width: 100%; height: 60%; display: flex; justify-content: center; align-items: center; }
      
      .carousel-card {
        background: white; width: 260px; padding: 20px; border-radius: 20px;
        text-align: center; border: 4px solid #f1c40f; display: none; 
        flex-direction: column; align-items: center;
        box-shadow: 0 10px 30px rgba(0,0,0,0.5);
      }
      .carousel-card.active { display: flex; } 
      .carousel-card img { width: 100%; height: 200px; object-fit: cover; border-radius: 10px; margin-bottom: 15px; border: 2px solid #eee; }
      
      .btn-gold { 
        background: #f1c40f; color: #1a1a2e; border: none; padding: 12px 30px; 
        font-family: 'Cinzel', serif; font-size: 16px; border-radius: 30px; 
        cursor: pointer; margin-top: 10px; font-weight: bold;
      }
      
      .nav-btn { 
        position: absolute; top: 50%; transform: translateY(-50%); 
        background: rgba(241, 196, 15, 0.8); width: 50px; height: 50px; 
        border-radius: 50%; border: none; font-size: 24px; cursor: pointer; z-index: 10; 
      }
      .prev-btn { left: 10px; } .next-btn { right: 10px; }

      /* --- SCANNER OVERLAY (Visible when AR is active) --- */
      #scan-overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        pointer-events: none; z-index: 1000; display: none;
      }
      #back-btn {
        position: absolute; top: 20px; left: 20px; pointer-events: auto;
        background: rgba(0,0,0,0.6); color: white; border: none; 
        padding: 10px 15px; border-radius: 50%; font-size: 20px; cursor:pointer;
      }
      #scan-hint {
        position: absolute; bottom: 30px; width: 100%; text-align: center;
        color: rgba(255,255,255,0.7); font-size: 14px; text-shadow: 1px 1px 2px black;
      }

      /* --- INFO POPUP (Holo Panel) --- */
      #holo-panel {
        position: fixed; top: 15%; left: 5%; width: 90%; height: 60%;
        background: rgba(16, 21, 30, 0.95); border: 2px solid #f1c40f;
        border-radius: 15px; color: #ecf0f1; padding: 20px; box-sizing: border-box;
        display: none; flex-direction: column; pointer-events: auto; z-index: 5000;
      }
      #holo-content { overflow-y: auto; line-height: 1.6; margin-top:10px; font-size: 16px; }
      .holo-close { align-self: flex-end; background: #e74c3c; color: white; border: none; padding: 8px 20px; border-radius: 5px; cursor: pointer; }

    </style>
  </head>

  <body>

    <div id="ui-layer">
      
      <div id="title-screen">
        <h1 style="font-family:'Cinzel',serif; font-size:32px; padding: 0 20px;">The Architects of Malaysia</h1>
        <button class="btn-gold" onclick="goToSelection()">ENTER GALLERY</button>
      </div>

      <div id="selection-screen">
        <h2 style="color:white; font-family:'Cinzel',serif;">Select Architect</h2>
        <div class="carousel-container">
          <button class="nav-btn prev-btn" onclick="moveSlide(-1)">&#10094;</button>
          <button class="nav-btn next-btn" onclick="moveSlide(1)">&#10095;</button>
          
          <div class="carousel-card active" id="card-0">
             <img src="./assets/hubback.png" onerror="this.src='https://via.placeholder.com/200?text=Hubback'">
             <h3>A.B. Hubback</h3> 
             <button class="btn-gold" onclick="launchAR('hubback')">VIEW IN 3D</button>
          </div>
          <div class="carousel-card" id="card-1">
             <img src="./assets/norman.png" onerror="this.src='https://via.placeholder.com/200?text=Norman'">
             <h3>A.C. Norman</h3> 
             <button class="btn-gold" onclick="launchAR('norman')">VIEW IN 3D</button>
          </div>
          <div class="carousel-card" id="card-2">
             <img src="./assets/bidwell.png" onerror="this.src='https://via.placeholder.com/200?text=Bidwell'">
             <h3>R.A.J Bidwell</h3> 
             <button class="btn-gold" onclick="launchAR('bidwell')">VIEW IN 3D</button>
          </div>
          <div class="carousel-card" id="card-3">
             <img src="./assets/spooner.png" onerror="this.src='https://via.placeholder.com/200?text=Spooner'">
             <h3>Charles Spooner</h3> 
             <button class="btn-gold" onclick="launchAR('spooner')">VIEW IN 3D</button>
          </div>
          </div>
      </div>
    </div>

    <div id="scan-overlay">
      <button id="back-btn" onclick="exitAR()">&#8592;</button>
      <div id="scan-hint">Scan the <b>Hiro Marker</b> to view</div>
    </div>

    <div id="holo-panel">
      <div style="display:flex; justify-content:space-between; align-items:center;">
        <h2 id="holo-title" style="margin:0; font-family:'Cinzel',serif; color:#f1c40f;">Info</h2>
        <button class="holo-close" onclick="closeHolo()">CLOSE</button>
      </div>
      <div id="holo-content">Content...</div>
    </div>

    <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;">
      
      <a-entity cursor="rayOrigin: mouse" raycaster="objects: .clickable"></a-entity>

      <a-marker preset="hiro">
        
        <a-entity rotation="-90 0 0" position="0 0 0">
            
            <a-image id="ar-portrait" src="" position="-1 0.5 0" width="1.2" height="1.5"></a-image>

            <a-text id="ar-name" value="LOADING..." position="-0.3 1.1 0" color="#f1c40f" width="5" font="mozillavr"></a-text>

            <a-entity position="0.8 0.5 0.1">
                <a-box class="clickable" color="#34495e" width="1.8" height="0.3" depth="0.1"
                       onclick="showData('bg')"></a-box>
                <a-text value="BACKGROUND INFO" align="center" color="white" z-offset="0.06" scale="1.2 1.2 1.2"></a-text>
            </a-entity>

            <a-entity position="0.8 0.1 0.1">
                <a-box class="clickable" color="#34495e" width="1.8" height="0.3" depth="0.1"
                       onclick="showData('con')"></a-box>
                <a-text value="CONTRIBUTION" align="center" color="white" z-offset="0.06" scale="1.2 1.2 1.2"></a-text>
            </a-entity>

            <a-entity position="0.8 -0.3 0.1">
                <a-box class="clickable" color="#f1c40f" width="1.8" height="0.3" depth="0.1"
                       onclick="showData('quiz')"></a-box>
                <a-text value="START QUIZ >" align="center" color="#1a1a2e" z-offset="0.06" scale="1.2 1.2 1.2" font="sourcecodepro"></a-text>
            </a-entity>
            
        </a-entity>

      </a-marker>
      
      <a-entity camera></a-entity>

    </a-scene>

    <script>
      // --- DATABASE ---
      const db = {
        hubback: {
          name: "A.B. HUBBACK",
          img: "./assets/hubback.png",
          bg: "Arthur Benison Hubback (1871-1948) was a British architect who designed many of Malaysia's most iconic colonial buildings.",
          con: "His major contributions include the Jamek Mosque, the chaotic yet beautiful Ipoh Railway Station, and the old Kuala Lumpur Railway Station.",
          quiz: "Hubback was responsible for which famous mosque? (Answer: Jamek Mosque)"
        },
        norman: {
          name: "A.C. NORMAN",
          img: "./assets/norman.png",
          bg: "A.C. Norman (1858-1944) served as a government architect in Malaya.",
          con: "He is best known for the ground plan of the Sultan Abdul Samad Building, although the facade style was later modified.",
          quiz: "What building's ground plan did Norman design? (Answer: Sultan Abdul Samad)"
        },
        bidwell: {
          name: "R.A.J BIDWELL",
          img: "./assets/bidwell.png",
          bg: "R.A.J Bidwell was a key figure in the transition of architectural styles in Malaya.",
          con: "He drafted the detailed plans for the Sultan Abdul Samad Building, shifting the style to Indo-Saracenic.",
          quiz: "Who drafted the detailed plans for the Sultan Abdul Samad Building?"
        },
        spooner: {
          name: "CHARLES SPOONER",
          img: "./assets/spooner.png",
          bg: "State Engineer Charles Spooner was the visionary who demanded a unique style for KL.",
          con: "He rejected the classical Renaissance style and ordered the use of 'Mahometan' (Islamic) style for government buildings.",
          quiz: "Spooner rejected Renaissance style in favor of what?"
        }
      };

      let currentId = null;

      // --- UI NAVIGATION ---
      function goToSelection() {
        document.getElementById('title-screen').style.display = 'none';
        document.getElementById('selection-screen').style.display = 'flex';
      }

      let slideIndex = 0;
      function moveSlide(n) {
        const cards = document.querySelectorAll('.carousel-card');
        cards[slideIndex].classList.remove('active');
        slideIndex += n;
        if(slideIndex >= cards.length) slideIndex = 0;
        if(slideIndex < 0) slideIndex = cards.length - 1;
        cards[slideIndex].classList.add('active');
      }

      // --- LAUNCH AR ---
      function launchAR(id) {
        currentId = id;
        const data = db[id];

        // 1. Update AR Content
        const portrait = document.querySelector('#ar-portrait');
        const nameText = document.querySelector('#ar-name');
        
        // Handle image: use placeholder if actual image fails or is missing in DB
        if(data.img) {
            portrait.setAttribute('src', data.img);
        } else {
            portrait.setAttribute('src', 'https://via.placeholder.com/300?text=No+Image');
        }
        
        nameText.setAttribute('value', data.name);

        // 2. Hide UI / Show Overlay
        document.getElementById('ui-layer').style.display = 'none';
        document.getElementById('scan-overlay').style.display = 'block';
      }

      function exitAR() {
        document.getElementById('scan-overlay').style.display = 'none';
        document.getElementById('ui-layer').style.display = 'flex';
        closeHolo();
      }

      // --- INTERACTIONS ---
      // Note: We attach these via HTML onclick attributes in the A-Frame entities above
      window.showData = function(type) {
        if(!currentId) return;
        const data = db[currentId];
        
        const panel = document.getElementById('holo-panel');
        const title = document.getElementById('holo-title');
        const content = document.getElementById('holo-content');
        
        panel.style.display = 'flex';

        if(type === 'bg') {
            title.innerText = "Background";
            content.innerText = data.bg;
        } else if (type === 'con') {
            title.innerText = "Contribution";
            content.innerText = data.con;
        } else if (type === 'quiz') {
            title.innerText = "Mini Quiz";
            content.innerText = data.quiz;
        }
      }

      window.closeHolo = function() {
        document.getElementById('holo-panel').style.display = 'none';
      }

    </script>
  </body>
</html>