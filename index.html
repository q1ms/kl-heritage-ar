<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Professional AR Museum</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.3.0/model-viewer.min.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Lato:wght@400;700&display=swap" rel="stylesheet">

    <style>
      body { margin: 0; padding: 0; font-family: 'Lato', sans-serif; background-color: #1a1a2e; color: white; }

      /* --- SELECTION SCREEN --- */
      #selection-screen {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: linear-gradient(135deg, #1a1a2e 0%, #0f1526 100%);
        z-index: 20; display: flex; flex-direction: column; align-items: center; justify-content: center;
      }
      .card-container { display: flex; gap: 20px; overflow-x: auto; width: 100%; padding: 20px; justify-content: center; }
      .card {
        background: white; color: black; border-radius: 15px; padding: 15px;
        width: 160px; text-align: center; border: 3px solid #f1c40f; cursor: pointer;
        transition: transform 0.2s;
      }
      .card:active { transform: scale(0.95); }
      .card img { width: 100%; height: 120px; object-fit: cover; border-radius: 10px; background: #ddd; }
      
      /* --- AR VIEWER --- */
      model-viewer {
        width: 100%; height: 100vh;
        background-color: #000;
        --poster-color: transparent;
      }

      /* --- HOTSPOTS (The Floating UI on the 3D Model) --- */
      .hotspot-panel {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 12px;
        border: 2px solid #f1c40f;
        padding: 15px;
        width: 220px;
        transform: translate3d(0, -50%, 0); /* Center it */
        box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        display: flex; flex-direction: column; align-items: center;
        text-align: center;
      }
      .hotspot-img { width: 80px; height: 80px; object-fit: cover; border-radius: 50%; border: 2px solid #2c3e50; margin-bottom: 8px; }
      .hotspot-title { font-family: 'Cinzel', serif; font-size: 16px; margin: 0 0 5px 0; color: #2c3e50; font-weight: bold; }
      
      .ar-btn {
        background: #2c3e50; color: white; border: none; padding: 8px 16px; 
        border-radius: 20px; margin: 4px 0; font-size: 12px; width: 100%; cursor: pointer;
      }
      .ar-btn:active { background: #f1c40f; color: black; }

      /* --- INFO POPUP --- */
      #info-overlay {
        position: fixed; bottom: 0; left: 0; width: 100%; background: white; 
        color: #333; border-top-left-radius: 20px; border-top-right-radius: 20px;
        padding: 20px; box-sizing: border-box; transform: translateY(100%);
        transition: transform 0.3s ease-out; z-index: 10;
      }
      #info-overlay.show { transform: translateY(0); }
      
      #back-btn {
        position: fixed; top: 20px; left: 20px; background: rgba(0,0,0,0.6); 
        color: white; padding: 10px 15px; border-radius: 50%; border:none; 
        font-size: 20px; display: none; z-index: 5;
      }

    </style>
  </head>
  <body>

    <div id="selection-screen">
      <h1 style="color:#f1c40f; font-family:'Cinzel',serif;">History AR</h1>
      <p>Select a figure to place in your room:</p>
      
      <div class="card-container">
        <div class="card" onclick="loadAR('hubback')">
          <img src="./assets/hubback.png" onerror="this.src='https://via.placeholder.com/150/2c3e50/FFFFFF?text=Hubback'">
          <h3>A.B. Hubback</h3>
        </div>
        <div class="card" onclick="loadAR('norman')">
          <img src="./assets/norman.png" onerror="this.src='https://via.placeholder.com/150/2c3e50/FFFFFF?text=Norman'">
          <h3>A.C. Norman</h3>
        </div>
      </div>
    </div>

    <model-viewer 
      id="viewer"
      src="https://modelviewer.dev/shared-assets/models/Astronaut.glb"
      ar 
      ar-modes="scene-viewer webxr quick-look" 
      camera-controls 
      shadow-intensity="1" 
      disable-zoom
      auto-rotate
      style="display:none;"
    >
      
      <button slot="hotspot-head" data-position="0 1.5 0" data-normal="0 0 1">
        
        <div class="hotspot-panel">
          <img id="ar-img" class="hotspot-img" src="">
          <div id="ar-name" class="hotspot-title">NAME</div>
          
          <button class="ar-btn" onclick="showData('bg')">Background Info</button>
          <button class="ar-btn" onclick="showData('con')">Contributions</button>
          <button class="ar-btn" onclick="showData('quiz')">Mini Quiz</button>
        </div>

      </button>

    </model-viewer>

    <button id="back-btn" onclick="exitAR()">&#8592;</button>

    <div id="info-overlay">
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
        <h2 id="info-title" style="margin:0; font-family:'Cinzel',serif; color:#f1c40f;">Title</h2>
        <button onclick="document.getElementById('info-overlay').classList.remove('show')" style="border:none; background:none; font-size:20px;">&times;</button>
      </div>
      <p id="info-body" style="line-height:1.6;">Content...</p>
    </div>

    <script>
      // DATABASE
      const db = {
        hubback: { 
          name: "A.B. HUBBACK", 
          img: "./assets/hubback.png",
          bg: "Arthur Benison Hubback was a British architect who designed the Jamek Mosque and KL Railway Station.",
          con: "He introduced the Indo-Saracenic style which defined colonial Malaya's architecture.",
          quiz: "Q: Which mosque did he design? \nA: Jamek Mosque."
        },
        norman: { 
          name: "A.C. NORMAN", 
          img: "./assets/norman.png",
          bg: "A.C. Norman was a senior government architect in the late 19th century.",
          con: "He is credited with the ground plan of the Sultan Abdul Samad Building.",
          quiz: "Q: What is his most famous building plan? \nA: Sultan Abdul Samad Building."
        }
      };

      let currentId = null;

      function loadAR(id) {
        currentId = id;
        const data = db[id];
        
        // 1. Update the Hotspot UI
        document.getElementById('ar-name').innerText = data.name;
        
        // Image Fallback
        const imgEl = document.getElementById('ar-img');
        imgEl.src = data.img;
        imgEl.onerror = function(){ this.src = 'https://via.placeholder.com/100'; };

        // 2. Switch Screens
        document.getElementById('selection-screen').style.display = 'none';
        
        const viewer = document.getElementById('viewer');
        viewer.style.display = 'block';
        document.getElementById('back-btn').style.display = 'block';

        // 3. Activate AR immediately (if supported)
        if (viewer.canActivateAR) {
          viewer.activateAR();
        }
      }

      function exitAR() {
        document.getElementById('viewer').style.display = 'none';
        document.getElementById('back-btn').style.display = 'none';
        document.getElementById('info-overlay').classList.remove('show');
        document.getElementById('selection-screen').style.display = 'flex';
      }

      function showData(type) {
        const data = db[currentId];
        const title = document.getElementById('info-title');
        const body = document.getElementById('info-body');
        
        if(type === 'bg') { title.innerText = "Background"; body.innerText = data.bg; }
        else if(type === 'con') { title.innerText = "Contribution"; body.innerText = data.con; }
        else { title.innerText = "Quiz"; body.innerText = data.quiz; }

        document.getElementById('info-overlay').classList.add('show');
      }
    </script>

  </body>
</html>