<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Historical Figures AR</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Lato:wght@400;700&display=swap" rel="stylesheet">

    <style>
      body { margin: 0; font-family: 'Lato', sans-serif; overflow: hidden; background: #2c3e50; }
      
      /* --- UTILITY CLASSES --- */
      .hidden { display: none !important; }
      .btn-gold {
        background: linear-gradient(to bottom, #f1c40f, #d4ac0d);
        color: #1a1a2e; border: 2px solid #fff; padding: 10px 30px;
        font-family: 'Cinzel', serif; font-weight: bold; border-radius: 25px;
        cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.3);
      }

      /* --- SCREEN 1: TITLE --- */
      #title-screen {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: linear-gradient(135deg, #1a1a2e 0%, #0f1526 100%);
        z-index: 3000; display: flex; flex-direction: column;
        justify-content: center; align-items: center; color: #f1c40f;
      }
      h1.main-title { font-family: 'Cinzel', serif; font-size: 36px; text-transform: uppercase; margin-bottom: 5px; }
      
      /* --- SCREEN 2: SELECTION --- */
      #selection-screen {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: #2c3e50; z-index: 2500; display: none;
        flex-direction: column; justify-content: center; align-items: center;
      }
      .char-card {
        background: white; width: 200px; padding: 15px; margin: 10px;
        border-radius: 10px; text-align: center; cursor: pointer;
        border: 4px solid #f1c40f;
      }

      /* --- SCREEN 3: PROFILE DASHBOARD (The New Request) --- */
      #profile-screen {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: #ecf0f1; z-index: 2000; display: none;
        flex-direction: column; align-items: center;
      }
      
      /* Top Bar */
      .profile-header {
        width: 100%; background: #1a1a2e; padding: 15px; color: #f1c40f;
        display: flex; align-items: center; justify-content: space-between;
        box-sizing: border-box;
      }
      
      /* The Layout */
      .profile-content {
        display: flex; flex-direction: column; align-items: center; width: 100%; padding-top: 20px;
      }
      
      /* The Character Image */
      .portrait-frame {
        width: 150px; height: 150px; background: #bdc3c7;
        border-radius: 50%; border: 5px solid #f1c40f;
        overflow: hidden; margin-bottom: 20px;
        background-size: cover; background-position: center;
      }

      /* The 3 Buttons Container */
      .menu-buttons { width: 80%; display: flex; flex-direction: column; gap: 15px; }

      /* The 3 Specific Buttons */
      .menu-btn {
        background: white; border: 2px solid #1a1a2e; color: #1a1a2e;
        padding: 15px; border-radius: 10px; font-weight: bold; text-align: left;
        display: flex; justify-content: space-between; align-items: center;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1); font-size: 16px;
      }
      .menu-btn:active { background: #e8e8e8; transform: scale(0.98); }
      .menu-btn.highlight { background: #1a1a2e; color: white; border: 2px solid #f1c40f; }

      /* Info Box (Popups for Background/Contribution) */
      #info-box {
        position: fixed; bottom: 0; width: 100%; background: white;
        border-top: 5px solid #f1c40f; padding: 20px; box-sizing: border-box;
        transform: translateY(100%); transition: transform 0.3s ease;
        z-index: 2200; box-shadow: 0 -5px 20px rgba(0,0,0,0.2);
      }
      #info-box.active { transform: translateY(0); }

      /* --- SCREEN 4: AR HUD (The Game) --- */
      #ar-hud {
        position: absolute; bottom: 20px; width: 100%; text-align: center;
        z-index: 1000; display: none;
      }
      .hud-box {
        background: rgba(0,0,0,0.8); color: white; padding: 15px;
        border-radius: 15px; display: inline-block; width: 90%;
      }

    </style>
  </head>

  <body>

    <div id="title-screen">
      <h1 class="main-title">Malaya<br>Heritage</h1>
      <p style="color:#bdc3c7; margin-bottom:40px;">Interactive History</p>
      <button class="btn-gold" onclick="nav('title-screen', 'selection-screen')">ENTER MUSEUM</button>
    </div>

    <div id="selection-screen">
      <h2 style="color:white; font-family:'Cinzel',serif;">Select a Figure</h2>
      
      <div class="char-card" onclick="openProfile('hubback')">
        <div style="height:100px; background:#ddd; margin-bottom:10px;"></div> <h3>A.B. Hubback</h3>
        <p>The Architect</p>
      </div>

      <div class="char-card" onclick="openProfile('jewkes')">
         <div style="height:100px; background:#ddd; margin-bottom:10px;"></div> <h3>Stanley Jewkes</h3>
        <p>The Engineer</p>
      </div>
    </div>

    <div id="profile-screen">
      <div class="profile-header">
        <span onclick="nav('profile-screen', 'selection-screen')" style="font-size:24px; cursor:pointer;">&#8592;</span>
        <span id="profile-name" style="font-family:'Cinzel',serif; font-size:18px;">Name Here</span>
        <span></span> </div>

      <div class="profile-content">
        <div id="profile-img" class="portrait-frame"></div>

        <div class="menu-buttons">
          
          <button class="menu-btn" onclick="showInfo('background')">
            <span>üìú Background</span>
            <span>&#8250;</span>
          </button>

          <button class="menu-btn" onclick="showInfo('contribution')">
            <span>üèóÔ∏è Contribution</span>
            <span>&#8250;</span>
          </button>

          <button class="menu-btn highlight" onclick="startAR()">
            <span>üèõÔ∏è Historical Buildings Built</span>
            <span>GO &#8594;</span>
          </button>

        </div>
      </div>
      
      <div id="info-box">
        <h3 id="info-title" style="margin-top:0;">Title</h3>
        <p id="info-text" style="line-height:1.5;">Content goes here...</p>
        <button onclick="closeInfo()" style="width:100%; padding:10px; margin-top:10px; background:#eee; border:none; border-radius:5px;">Close</button>
      </div>
    </div>

    <div id="ar-hud">
      <div class="hud-box">
        <h3>Building Challenge</h3>
        <p>Spooner demands a change. Fix the roof!</p>
        <button class="btn-gold" style="background:#e74c3c; border:none;" onclick="alert('Wrong!')">Gothic</button>
        <button class="btn-gold" onclick="finishGame()">Onion Dome</button>
      </div>
    </div>

    <a-scene mindar-image="imageTargetSrc: ./assets/targets.mind;" vr-mode-ui="enabled: false" device-orientation-permission-ui="enabled: false">
      <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>
      
      <a-entity mindar-image-target="targetIndex: 0" id="target-entity">
        <a-cylinder position="0 0 0" radius="0.3" height="1" color="#8B4513"></a-cylinder>
        <a-torus position="0 0 0.3" radius="0.1" radius-tubular="0.02" arc="180" color="white"></a-torus>
        <a-sphere id="onion-dome" position="0 0.5 0" radius="0.32" color="#FFD700" visible="false"></a-sphere>
      </a-entity>
    </a-scene>

    <script>
      [cite_start]// --- DATA: The Information for your figures [cite: 2] ---
      const db = {
        hubback: {
          name: "A.B. Hubback",
          img: "url('./assets/hubback.png')", // Make sure you have this image!
          background: "Born in Liverpool in 1871. He served as a Brigadier General in the British Army during WWI.",
          contribution: "He was the Assistant Architect to the PWD. He designed over 25 significant buildings in British Malaya."
        },
        jewkes: {
          name: "Stanley Jewkes",
          img: "url('./assets/jewkes.png')",
          background: "An American architect and engineer prominent in the post-war era.",
          contribution: "Famous for designing the Stadium Merdeka for the Declaration of Independence in 1957."
        }
      };

      let currentCharacter = null;

      // --- NAVIGATION ---
      function nav(fromId, toId) {
        document.getElementById(fromId).style.display = 'none';
        document.getElementById(toId).style.display = 'flex';
      }

      function openProfile(charId) {
        currentCharacter = db[charId]; // Load data
        
        // Update HTML with Data
        document.getElementById('profile-name').innerText = currentCharacter.name;
        document.getElementById('profile-img').style.backgroundImage = currentCharacter.img;
        
        nav('selection-screen', 'profile-screen');
      }

      // --- INFO BUTTONS ---
      function showInfo(type) {
        const box = document.getElementById('info-box');
        const title = document.getElementById('info-title');
        const text = document.getElementById('info-text');

        if (type === 'background') {
          title.innerText = "Background";
          text.innerText = currentCharacter.background;
        } else if (type === 'contribution') {
          title.innerText = "Contribution";
          text.innerText = currentCharacter.contribution;
        }

        box.classList.add('active'); // Slide up
      }

      function closeInfo() {
        document.getElementById('info-box').classList.remove('active');
      }

      // --- START AR ---
      function startAR() {
        // Hide UI, Show AR Instructions
        document.getElementById('profile-screen').style.display = 'none';
        alert("Mission: Point your camera at the " + currentCharacter.name + " poster to see his buildings!");
        
        // The AR logic listens for the target
        const target = document.querySelector('#target-entity');
        const hud = document.getElementById('ar-hud');

        target.addEventListener("targetFound", event => {
          hud.style.display = 'block';
        });
        target.addEventListener("targetLost", event => {
          hud.style.display = 'none';
        });
      }

      function finishGame() {
        document.getElementById('onion-dome').setAttribute('visible', 'true');
        alert("Success! You built the correct roof.");
      }
    </script>
  </body>
</html>