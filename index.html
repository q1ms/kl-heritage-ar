<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Historical Figures AR</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Lato:wght@400&display=swap" rel="stylesheet">

    <style>
      body { margin: 0; font-family: 'Lato', sans-serif; overflow: hidden; }

      /* --- SCREEN 1: TITLE SCREEN (New Beautiful Menu) --- */
      #title-screen {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); /* Dark Blue Theme */
        z-index: 2000;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        color: #f1c40f; /* Gold Text */
      }

      /* The App Title */
      h1.main-title {
        font-family: 'Cinzel', serif; /* Historical Font */
        font-size: 40px;
        text-transform: uppercase;
        letter-spacing: 2px;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        text-align: center;
      }

      p.subtitle { color: #ecf0f1; font-size: 14px; margin-bottom: 50px; }

      /* The BIG START BUTTON */
      .start-btn {
        background: linear-gradient(to bottom, #f1c40f, #d4ac0d);
        color: #1a1a2e;
        border: 2px solid #fff;
        padding: 15px 60px;
        font-size: 24px;
        font-family: 'Cinzel', serif;
        font-weight: bold;
        border-radius: 50px;
        cursor: pointer;
        box-shadow: 0 0 20px rgba(241, 196, 15, 0.4);
        transition: transform 0.2s;
      }
      .start-btn:active { transform: scale(0.95); }

      /* Side Buttons (Info & Settings) */
      .side-btn {
        position: absolute;
        width: 50px; height: 50px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        color: white;
        font-size: 20px;
        cursor: pointer;
        display: flex; align-items: center; justify-content: center;
      }
      #btn-info { top: 20px; right: 20px; }
      #btn-settings { top: 20px; left: 20px; }

      /* --- SCREEN 2: CHARACTER SELECTION (From previous step) --- */
      #selection-screen {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: #2c3e50;
        z-index: 1000;
        display: none; /* Hidden initially */
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }
      .character-card {
        background: white; color: black;
        padding: 20px; margin: 15px; border-radius: 15px;
        width: 220px; text-align: center;
        cursor: pointer; border: 4px solid #f1c40f;
        box-shadow: 0 5px 15px rgba(0,0,0,0.3);
      }

      /* --- SCREEN 3: AR GAME UI --- */
      #game-ui {
        position: absolute; bottom: 30px; left: 0; width: 100%;
        text-align: center; z-index: 500; display: none;
      }
      .game-btn {
        background: #e74c3c; color: white; border: none;
        padding: 12px 24px; font-size: 16px; border-radius: 30px; margin: 5px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.3);
      }

      /* --- POPUP BOXES (Info/Settings) --- */
      .popup {
        position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
        width: 80%; background: white; color: #333; padding: 20px;
        border-radius: 15px; z-index: 3000; display: none; text-align: center;
        box-shadow: 0 0 50px rgba(0,0,0,0.7); border: 2px solid #f1c40f;
      }
      .close-btn {
        background: #333; color: white; border: none; padding: 8px 20px;
        margin-top: 15px; border-radius: 5px; cursor: pointer;
      }

    </style>
  </head>

  <body>

    <div id="title-screen">
      <button id="btn-settings" class="side-btn" onclick="toggleSettings()">⚙️</button>
      <button id="btn-info" class="side-btn" onclick="toggleInfo()">ℹ️</button>

      <h1 class="main-title">Malaya<br>History AR</h1>
      <p class="subtitle">Experience the Past</p>
      
      <button class="start-btn" onclick="goToSelection()">START</button>
    </div>

    <div id="info-popup" class="popup">
      <h2>About Us</h2>
      <p>Created by Group 5 for the AR Heritage Project.</p>
      <button class="close-btn" onclick="toggleInfo()">Close</button>
    </div>

    <div id="settings-popup" class="popup">
      <h2>Settings</h2>
      <p>Audio: ON</p>
      <p>Language: English</p>
      <button class="close-btn" onclick="toggleSettings()">Close</button>
    </div>

    <div id="selection-screen">
      <h2 style="color:white; font-family:'Cinzel', serif;">Select Architect</h2>
      
      <div class="character-card" onclick="startAR('hubback')">
        <h3>A.B. Hubback</h3>
        <p>The Architect</p>
      </div>
      
      <div class="character-card" onclick="startAR('jewkes')">
        <h3>Stanley Jewkes</h3>
        <p>The Engineer</p>
      </div>

      <button style="margin-top:20px; background:none; border:none; color:white; text-decoration:underline;" onclick="goBackToTitle()">Back</button>
    </div>

    <div id="game-ui">
      <div style="background:rgba(0,0,0,0.8); color:white; padding:15px; border-radius:15px; display:inline-block;">
        <p style="margin:0 0 10px 0;">Fix the Roof Design:</p>
        <button class="game-btn" onclick="wrongMove()">Gothic Spire</button>
        <button class="game-btn" onclick="finishBuilding()">Onion Dome</button>
      </div>
    </div>

    <a-scene mindar-image="imageTargetSrc: ./assets/targets.mind;" vr-mode-ui="enabled: false" device-orientation-permission-ui="enabled: false">
      <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>
      <a-entity mindar-image-target="targetIndex: 0" id="target-entity">
        <a-cylinder position="0 0 0" radius="0.3" height="1" color="#8B4513"></a-cylinder>
        <a-torus position="0 0 0.3" radius="0.1" radius-tubular="0.02" arc="180" color="white"></a-torus>
        <a-sphere id="onion-dome" position="0 0.5 0" radius="0.32" color="#FFD700" visible="false"></a-sphere>
      </a-entity>
    </a-scene>

    <script>
      const titleScreen = document.getElementById('title-screen');
      const selectScreen = document.getElementById('selection-screen');
      const gameUI = document.getElementById('game-ui');
      const arTarget = document.getElementById('target-entity');
      const dome = document.getElementById('onion-dome');

      let gameActive = false;

      // Navigation Functions
      function goToSelection() {
        titleScreen.style.display = 'none';
        selectScreen.style.display = 'flex';
      }

      function goBackToTitle() {
        selectScreen.style.display = 'none';
        titleScreen.style.display = 'flex';
      }

      function startAR(character) {
        selectScreen.style.display = 'none';
        alert("Point camera at your image target!");
        gameActive = true;
      }

      // Popups
      function toggleInfo() {
        const p = document.getElementById('info-popup');
        p.style.display = p.style.display === 'block' ? 'none' : 'block';
      }

      function toggleSettings() {
        const p = document.getElementById('settings-popup');
        p.style.display = p.style.display === 'block' ? 'none' : 'block';
      }

      // AR Logic
      arTarget.addEventListener("targetFound", event => {
        if(gameActive) gameUI.style.display = 'block';
      });
      arTarget.addEventListener("targetLost", event => {
        gameUI.style.display = 'none';
      });

      function finishBuilding() {
        dome.setAttribute('visible', 'true');
        gameUI.style.display = 'none';
        setTimeout(() => alert("Correct! You built the Indo-Saracenic dome."), 500);
      }

      function wrongMove() {
        alert("Incorrect style!");
      }
    </script>
  </body>
</html>