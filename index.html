<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Malaysian Architects AR</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.3.0/model-viewer.min.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Lato:wght@400;700&display=swap" rel="stylesheet">

    <style>
      body { margin: 0; background-color: #1a1a2e; font-family: 'Lato', sans-serif; overflow: hidden; }
      
      /* THE 3D WINDOW */
      model-viewer {
        width: 100%; height: 100vh;
        background: radial-gradient(circle at center, #2c3e50 0%, #000000 100%);
      }

      /* INFO PANEL (Top) */
      #info-panel {
        position: absolute; top: 20px; left: 50%; transform: translateX(-50%);
        width: 85%; max-width: 400px;
        background: rgba(255, 255, 255, 0.95);
        padding: 20px; border-radius: 12px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        text-align: center; border-bottom: 4px solid #f1c40f;
      }
      
      h1 { margin: 0 0 5px 0; font-family: 'Cinzel', serif; color: #2c3e50; font-size: 22px; }
      p { margin: 0; font-size: 14px; color: #555; line-height: 1.4; }

      /* BUTTONS (Bottom) */
      #controls {
        position: absolute; bottom: 40px; width: 100%;
        display: flex; justify-content: center; gap: 15px;
        pointer-events: none; /* Let touches pass through */
      }

      .btn {
        pointer-events: auto; /* Enable clicking */
        background: rgba(255, 255, 255, 0.2);
        backdrop-filter: blur(10px);
        border: 2px solid white; color: white;
        padding: 12px 24px; border-radius: 30px;
        font-weight: bold; cursor: pointer;
        font-family: 'Cinzel', serif;
        box-shadow: 0 4px 6px rgba(0,0,0,0.3);
      }

      .btn.active {
        background: #f1c40f; color: #1a1a2e; border-color: #f1c40f;
        transform: scale(1.1); box-shadow: 0 0 15px rgba(241, 196, 15, 0.6);
      }

      /* SECURITY WARNING (Shows if not HTTPS) */
      #https-warning {
        display: none; position: absolute; top: 0; left: 0; width: 100%;
        background: #e74c3c; color: white; text-align: center; padding: 10px;
        font-weight: bold; z-index: 9999;
      }
    </style>
  </head>
  <body>

    <div id="https-warning">‚ö†Ô∏è AR requires HTTPS. Camera may not load.</div>

    <model-viewer 
      id="viewer"
      src="./hubback.glb" 
      ios-src="./hubback.usdz"
      alt="Architectural Figure"
      shadow-intensity="1"
      camera-controls
      auto-rotate
      ar
      ar-modes="webxr scene-viewer quick-look"
      ar-scale="auto"
    >
      <button slot="ar-button" style="background-color: white; border-radius: 30px; border: none; position: absolute; top: 16px; right: 16px; padding: 10px 20px; font-weight:bold; color:#2c3e50; box-shadow: 0 2px 5px rgba(0,0,0,0.2);">
        üì∑ VIEW IN ROOM
      </button>
    </model-viewer>

    <div id="info-panel">
      <h1 id="name">A.B. HUBBACK</h1>
      <p id="desc">Renowned for designing the Jamek Mosque and the Kuala Lumpur Railway Station.</p>
    </div>

    <div id="controls">
      <button class="btn active" onclick="loadModel('hubback', this)">HUBBACK</button>
      <button class="btn" onclick="loadModel('norman', this)">NORMAN</button>
    </div>

    <script>
      // 1. DATABASE
      // Make sure you have ALL 4 files in your folder!
      const data = {
        hubback: {
          glb: './hubback.glb',
          usdz: './hubback.usdz',
          name: "A.B. HUBBACK",
          desc: "Renowned for designing the Jamek Mosque and the Kuala Lumpur Railway Station."
        },
        norman: {
          glb: './norman.glb',
          usdz: './norman.usdz',
          name: "A.C. NORMAN",
          desc: "The Government Architect who created the ground plans for the Sultan Abdul Samad Building."
        }
      };

      // 2. LOGIC
      const viewer = document.getElementById('viewer');
      const nameEl = document.getElementById('name');
      const descEl = document.getElementById('desc');

      function loadModel(id, btn) {
        // Update UI
        document.querySelectorAll('.btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');

        // Update Text
        nameEl.innerText = data[id].name;
        descEl.innerText = data[id].desc;

        // Update 3D Model (Must update BOTH Android and iOS sources)
        viewer.src = data[id].glb;
        viewer.setAttribute('ios-src', data[id].usdz);
      }

      // 3. SECURITY CHECK
      // This checks if you are running on a secure server.
      if (location.protocol !== 'https:' && location.hostname !== 'localhost' && location.hostname !== '127.0.0.1') {
          document.getElementById('https-warning').style.display = 'block';
      }

      // 4. DEBUGGING
      viewer.addEventListener('error', (e) => {
        console.error("Model failed to load:", e);
        alert("Error: Model file not found. Check console for details.");
      });

    </script>
  </body>
</html>